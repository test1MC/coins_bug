<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-gb">
    <head>
        <link href="../../../Resources/TableStyles/COINS.css" rel="stylesheet" MadCap:stylesheetType="table" /><title></title>
        <link href="../../../Resources/Stylesheets/OnlineHelp.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>
            <MadCap:concept term="Topics" />Query Editor</h1>
        <p>The Query Editor allows you to try out 4GL queries against the <MadCap:variable name="General.ProductName" /> database and sample the data returned. This function can be useful to test queries before being used in reports or enquiries.</p>
        <MadCap:dropDown class="screenshot">
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot MadCap:autonum="Screenshot: ">Query Editor Screen</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>
                    <img src="../../../Resources/Images_A-C/BI/BI Utilities/Query Editor_1106.png" class="FullWidth" />
                </p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p>To use the query editor simply enter the query, and (optionally) any fields required - space separated - and click <span class="Button">RUN</span>.&#160; The system will return an error if any part of the query is incorrect – and a sample of data if the query compiles OK.&#160; </p>
        <p>&#160;</p>
        <p class="note">If the fields section was left blank, all fields will be displayed.&#160; If field names were specified, only those fields will be shown.</p>
        <MadCap:dropDown class="screenshot">
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot MadCap:autonum="Screenshot: ">Query Editor Results</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>
                    <img src="../../../Resources/Images_A-C/BI/BI Utilities/Query Editor_1_1106.png" class="FullWidth" />
                </p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <table style="margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/TableStyles/COINS.css');" class="TableStyle-COINS" cellspacing="0">
            <col class="TableStyle-COINS-Column-Column1" />
            <col class="TableStyle-COINS-Column-Column1" />
            <thead>
                <tr class="TableStyle-COINS-Head-Header1">
                    <th class="TableStyle-COINS-HeadE-Column1-Header1">Field</th>
                    <th class="TableStyle-COINS-HeadD-Column1-Header1">Descrription</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-COINS-Body-Body1">
                    <td class="TableStyle-COINS-BodyE-Column1-Body1">
                        <p>Data Set</p>
                    </td>
                    <td class="TableStyle-COINS-BodyD-Column1-Body1">
                        <p>A Data Set definition can be entered here to display the information created in the data set (No query or fields are required for this).</p>
                    </td>
                </tr>
                <tr class="TableStyle-COINS-Body-Body1">
                    <td class="TableStyle-COINS-BodyE-Column1-Body1">
                        <p>Condition Field</p>
                    </td>
                    <td class="TableStyle-COINS-BodyD-Column1-Body1">
                        <p>A function that determines whether a record should be included or not. The function returns a logical value: yes to include the record, no to exclude it.</p>
                    </td>
                </tr>
                <tr class="TableStyle-COINS-Body-Body1">
                    <td class="TableStyle-COINS-BodyE-Column1-Body1">
                        <p>Maximum Rows</p>
                    </td>
                    <td class="TableStyle-COINS-BodyD-Column1-Body1">
                        <p>Allows the query to fun faster by only displaying a maximum number of rows per query.&#160; 10.23 onwards, this defaults to 10</p>
                    </td>
                </tr>
                <tr class="TableStyle-COINS-Body-Body1">
                    <td class="TableStyle-COINS-BodyB-Column1-Body1">
                        <p>Extra Parameters (10.23 onwards)</p>
                    </td>
                    <td class="TableStyle-COINS-BodyA-Column1-Body1">
                        <p>Where a dataset has been specified, this field allows entry of&#160; of parameters&#160; (URL) that are needed by the dataset query.</p>
                        <p>e.g. </p>
                        <p>The parameterised fields are so that you don't have to 'hard code' queries in the dataset to get it to run in the query editor – particularly if there are date replacements etc with fields like {RS_glp_fdate__2}.&#160;&#160; Or another useful reason for using these parameters is so that you can test results in a efficient way&#160; for instance:&#160; if you have a query on the dataset&#160; which reads: </p>
                        <p>FOR EACH jc_job WHERE jc_job.kco = {kco} {jobSelect}</p>
                        <p>You could call the dataset from within the query editor and in the parameters say&#160;&#160;&#160;&#160;&#160; jobSelect=and jc_job.job_num = 'XXXX'&#160;&#160; (where XXXX is a vailid contract number). </p>
                        <p>That way the dataset would run but for only contract XXXX&#160; -&#160;&#160; This is good to save time in checking the validation of fields in the dataset as you don't have to wait till the whole dataset evaluates prior to getting a response back.</p>
                        <p>If you have more than one {} replacement in your dataset then you would separate the parameters with a &amp; symbol&#160;&#160;&#160;&#160;&#160; Eg:&#160;&#160; Dataset query might read :</p>
                        <p>FOR EACH jc_job WHERE jc_job.kco = {kco} {jobSelect},</p>
                        <p>&#160;&#160; EACH jc_costcode of jc_job WHERE TRUE {jccSelect}</p>
                        <p>You could call the dataset from within the query editor and in the parameters say&#160;&#160;&#160;&#160;&#160; jobSelect=and jc_job.job_num = 'XXXX' &amp;jccSelect= and jc_costcode.jcc_cc = 'YYYY'&#160;&#160;&#160; (where XXXX is a vailid contract number and YYYY is a valid Costcode).</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>DB Fields defined as array in the Database Enquiry such as avm_add[4] can be entered without the index of elements to display all elements (previously the element would need to be specified such as avm_add__1, avm_add__2 etc.)</p>
        <MadCap:dropDown class="screenshot">
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot MadCap:autonum="Screenshot: ">Query Editor Results - Array Fields</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>
                    <img src="../../../Resources/Images_A-C/BI/BI Utilities/Query Editor_4_1106.png" class="FullWidth" />
                </p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p>Wildcards can be used in “Fields” on Query Editor screen to mask fields </p>
        <MadCap:dropDown class="screenshot">
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Query Editor Results - Wildcards</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>
                    <img src="../../../Resources/Images_A-C/BI/BI Utilities/Query Editor_5_1106.png" class="FullWidth" />
                </p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <h2>Search and Replace</h2>
        <p>Clicking <span class="Button">Search</span> allows you to search for a character string within the Query. This is particularly useful for large queries. </p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI Utilities/Query Editor_SR1_1106.png" class="FullWidth" />
        </p>
        <p>If found, the string will be highlighted within the query.</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI Utilities/Query Editor_SR2_1106.png" class="FullWidth" />
        </p>
        <p>Clicking <span class="Button">Replace All</span> will prompt for the search string to be replaced</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI Utilities/Query Editor_SR3_1106.png" class="FullWidth" />
        </p>
        <p>Enter the required string and click Enter. The system will then prompt for the replacement string.</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI Utilities/Query Editor_SR4_1106.png" class="FullWidth" />
        </p>
        <p>Enter the replace ment string and press Enter. The system will then replace all instances of original text with the replacement string.</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI Utilities/Query Editor_SR5_1106.png" class="FullWidth" />
        </p>
        <h2>Exporting from the Query Editor</h2>
        <p>To export the query and associated results to excel simply click <span class="Button">Export</span> . The query editor will then open the data set in a new screen. This information can then be exported to Excel by right-clicking anywhere in the data table.</p>
        <p>The spread sheet created will contain the appropriate query and links to coins so that the data can be refreshed at any point.</p>
        <h2>Saving Queries in Query Editor (10.27)</h2>
        <p>To prevent the need to keep re-typing regularly used queries, save and load options are available as of v10.27 and are located at the top of the Query Editor page. </p>
        <p>Once you have set up your query and selected the required fields, in the Stored fields, specify a name for the query and a description to further identify it.</p>
        <p>Click <span class="Button">Save </span></p>
        <p>The Query will now be stored and can be retrieved at any time by running Query Editor, specifying the Query name and clicking <span class="Button">Load</span> button.</p>
        <p>To delete a saved query, specify the name and select the Delete button.</p>
        <p>The full list of stored queries may be viewed from the new Queries option from the OA Reporting and BI Utilities Menu</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI Utilities/Queries_1106.png" class="FullWidth" />
        </p>
        <p>This screen will allow the creation, deletion and maintenance of the stored queries.&#160; </p>
        <p class="note">To see the results of the queries, you will need to return to Query Editor and Load the appropriate query.</p>
        <p>&#160;</p>
    </body>
</html>