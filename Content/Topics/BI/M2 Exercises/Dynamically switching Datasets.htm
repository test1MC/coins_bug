<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-gb" style="mc-master-page: url('../../../Resources/MasterPages/OtherTopics.flmsp');">
    <head><title></title>
        <link href="../../../Resources/Stylesheets/OnlineHelp.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>
            <MadCap:concept term="Topics" />Exercise 1d – Dynamically switching between multiple Data Sets </h1>
        <p>This exercise will demonstrate how you can dynamically select the data set to be used in a report</p>
        <h2>Create the Function and Menu </h2>
        <p>Create the function that will be used to run the report then add this function to an appropriate menu.&#160; </p>
        <table style="width: 100%; margin-left: 0; margin-right: auto;">
            <col />
            <col />
            <tbody>
                <tr>
                    <td>Function Code</td>
                    <td>Initials + M2 + Exercise No.e.g. NLM2Exercise1d</td>
                </tr>
                <tr>
                    <td>Function Name</td>
                    <td>Description identifier.E.g. NLM2EX1d</td>
                </tr>
                <tr>
                    <td>Function Module</td>
                    <td>Contract Status</td>
                </tr>
                <tr>
                    <td>Function Category</td>
                    <td>Report</td>
                </tr>
                <tr>
                    <td>Function Context</td>
                    <td>Leave as defaulted from the Function Description.</td>
                </tr>
                <tr>
                    <td>Function Program</td>
                    <td>wou005</td>
                </tr>
            </tbody>
        </table>
        <p>We already have a page that we can re-use from the first exercise so the following parameter will allow us to use this:</p>
        <p>Function Parametersstn_code=nlm2exercise1</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Exercise 1d Dynamically switching.png" class="FullWidth" />
        </p>
        <h2>Build the datasets</h2>
        <p>For this example, we will use the datasets nlm2ds3 and nlm2ds4 that we created in the previous exercise so there is no need to build new ones.</p>
        <h2>Create the page</h2>
        <p>Copy the page nlm2exercise1 and call it nlm2exercise1d</p>
        <p>Add a new field to the update form called RS_Dataset with a view as of Combo Description/Value.&#160; The populate field should be as follows:</p>
        <p>sys002.combo^nlm2ds3,SL,nlm2ds4,CS</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Exercise 1d Dynamically switching_1.png" class="FullWidth" />
        </p>
        <p>This will create a dropdown selection field that will allow us to select either SL or CS and the corresponding name of the datasets (either nlm2ds3 or nlm2ds4) will be returned.</p>
        <h2>Create the Report</h2>
        <p>Copy the report definition for xxM2exercise1b and rename it xxM2exercise1d.</p>
        <p>For this new report, the query can be left as it is, since the query tables are correct, however we don’t want to specify thedataset names to be used, instead we want the selection page to control this</p>
        <p>In the Data Set Definition field, replace the dataset names with dataset selection field from the page i.e.&#160; {RS_Dataset}.</p>
        <p> <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Exercise 1d Dynamically switching_2.png" class="FullWidth" /></p>
        <h2>Running the report</h2>
        <p>Run the function xxM2Exercise1d.&#160; The page should offer the dropdown field to let you change the datasets</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Exercise 1d Dynamically switching_3.png" class="FullWidth" />
        </p>
        <p>Run the report twice with each a different dataset selection and verify that the figures are different.</p>
        <p> </p>
    </body>
</html>