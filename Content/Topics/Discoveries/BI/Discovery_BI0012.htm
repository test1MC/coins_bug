<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-gb" MadCap:lastBlockDepth="6" MadCap:lastHeight="10081" MadCap:lastWidth="1349" MadCap:snippetVariables="Topic Variables.Discovery Number:BI0012,">
    <head>
        <link href="../../../Resources/TableStyles/COINSBasic.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>OA Designer - Using Multiple Datasets in a Report</title>
        <link href="../../../Resources/Stylesheets/OnlineHelp.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <MadCap:snippetBlock src="../../../Resources/Snippets/Dicscovery Heading.flsnp" />
        <p>
            <MadCap:relatedTopics>
                <MadCap:relatedTopic src="Discovery_BI0009.htm" />
                <MadCap:relatedTopic src="Discovery_BI0010.htm" />
                <MadCap:relatedTopic src="Discovery_BI0011.htm" />
            </MadCap:relatedTopics>
        </p>
        <h1>Using multiple Data Sets</h1>
        <p>This exercise will demonstrate how multiple Data Sets can be used in a report. </p>
        <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;">You will need to have completed Discoveries BI0009 and BI0011 before attempting this exercise.</p>
        <h2>Create the Function and Menu </h2>
        <p>Create the function that will be used to run the report then add this function to an appropriate menu. </p>
        <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;">Replace xx with your initials.</p>
        <table style="width: 100%; mc-table-style: url('../../../Resources/TableStyles/COINSBasic.css'); margin-left: 0; margin-right: auto;" class="TableStyle-COINSBasic" cellspacing="0">
            <col class="TableStyle-COINSBasic-Column-Column1" />
            <col class="TableStyle-COINSBasic-Column-Column1" />
            <tbody>
                <tr class="TableStyle-COINSBasic-Body-Body1">
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">Function Code</td>
                    <td class="TableStyle-COINSBasic-BodyD-Column1-Body1">xxBI0012</td>
                </tr>
                <tr class="TableStyle-COINSBasic-Body-Body1">
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">Function Name</td>
                    <td class="TableStyle-COINSBasic-BodyD-Column1-Body1">xxBI0012</td>
                </tr>
                <tr class="TableStyle-COINSBasic-Body-Body1">
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">Function Module</td>
                    <td class="TableStyle-COINSBasic-BodyD-Column1-Body1">Contract Status</td>
                </tr>
                <tr class="TableStyle-COINSBasic-Body-Body1">
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">Function Category</td>
                    <td class="TableStyle-COINSBasic-BodyD-Column1-Body1">Report</td>
                </tr>
                <tr class="TableStyle-COINSBasic-Body-Body1">
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">Function Context </td>
                    <td class="TableStyle-COINSBasic-BodyD-Column1-Body1">Leave as defaulted from the Function Description</td>
                </tr>
                <tr class="TableStyle-COINSBasic-Body-Body1">
                    <td class="TableStyle-COINSBasic-BodyB-Column1-Body1">Function Program </td>
                    <td class="TableStyle-COINSBasic-BodyA-Column1-Body1">wou005</td>
                </tr>
            </tbody>
        </table>
        <p>We already have a page that we can re-use from Discovery  BI0011 so the following parameter will allow us to use this:</p>
        <table style="width: 100%; mc-table-style: url('../../../Resources/TableStyles/COINSBasic.css'); margin-left: 0; margin-right: auto;" class="TableStyle-COINSBasic" cellspacing="0">
            <col class="TableStyle-COINSBasic-Column-Column1" />
            <col class="TableStyle-COINSBasic-Column-Column1" />
            <tbody>
                <tr class="TableStyle-COINSBasic-Body-Body1">
                    <td class="TableStyle-COINSBasic-BodyB-Column1-Body1">Function Parameters</td>
                    <td class="TableStyle-COINSBasic-BodyA-Column1-Body1">stn_code=xxBI0011</td>
                </tr>
            </tbody>
        </table>
        <p>&#160;</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Exercise 1b Using multiple_A_1106.png" class="FullWidth" />
        </p>
        <p>Click <MadCap:snippetText src="../../../Resources/Snippets/Button Snippets/Button_LineSave_Both.flsnp" /></p>
        <h2>Creating the new Data Set</h2>
        <p>In Designer, navigate to Data Set Definitions.</p>
        <p>Click <MadCap:snippetText src="../../../Resources/Snippets/Button Snippets/Button_Add_Both.flsnp" /></p>
        <p>Enter a Data Set name and description for the data set.&#160; For this exercise use your initials followed by BI0012.</p>
        <p>In the Query box, enter:</p>
        <p class="Example">FOR EACH jc_job WHERE jc_job.kco = {kco} {jobSelect}, <br />EACH ap_invoice OF jc_job .</p>
        <p>We need to create an identifier for the Data Set table name.&#160; In this example call your table plinvoice</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Running the Report_1.png" class="FullWidth" MadCap:conditions="COINS.Pre-v1105" />
        </p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Exercise 1b Using multiple_B_1106.png" class="FullWidth" />
        </p>
        <p>Click <MadCap:snippetText src="../../../Resources/Snippets/Button Snippets/Button_Save_Both.flsnp" /></p>
        <h2>Adding the Fields</h2>
        <p>On the Fields Tab, click <MadCap:snippetText src="../../../Resources/Snippets/Button Snippets/Button_Add_Both.flsnp" /> and add the following fields:</p>
        <table style="width: 100%; mc-table-style: url('../../../Resources/TableStyles/COINSBasic.css'); margin-left: 0; margin-right: auto;" class="TableStyle-COINSBasic" cellspacing="0">
            <col class="TableStyle-COINSBasic-Column-Column1" />
            <col class="TableStyle-COINSBasic-Column-Column1" />
            <col class="TableStyle-COINSBasic-Column-Column1" />
            <col class="TableStyle-COINSBasic-Column-Column1" />
            <col class="TableStyle-COINSBasic-Column-Column1" />
            <thead>
                <tr class="TableStyle-COINSBasic-Head-Header1">
                    <th class="TableStyle-COINSBasic-HeadE-Column1-Header1">
                        <p class="TableHeader">Field</p>
                    </th>
                    <th class="TableStyle-COINSBasic-HeadE-Column1-Header1">
                        <p class="TableHeader">Label</p>
                    </th>
                    <th class="TableStyle-COINSBasic-HeadE-Column1-Header1">
                        <p class="TableHeader">Data Type</p>
                    </th>
                    <th class="TableStyle-COINSBasic-HeadE-Column1-Header1">
                        <p class="TableHeader">Format</p>
                    </th>
                    <th class="TableStyle-COINSBasic-HeadD-Column1-Header1">
                        <p class="TableHeader">Source</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-COINSBasic-Body-Body1">
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">kco</td>
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">Company</td>
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">Integer</td>
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">-&gt;&gt;&gt;,&gt;&gt;&gt;,&gt;&gt;9</td>
                    <td class="TableStyle-COINSBasic-BodyD-Column1-Body1">jc_job.kco</td>
                </tr>
                <tr class="TableStyle-COINSBasic-Body-Body1">
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">job_num</td>
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">Contract</td>
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">Character</td>
                    <td class="TableStyle-COINSBasic-BodyE-Column1-Body1">x(8)</td>
                    <td class="TableStyle-COINSBasic-BodyD-Column1-Body1">jc_job.job_num</td>
                </tr>
                <tr class="TableStyle-COINSBasic-Body-Body1">
                    <td class="TableStyle-COINSBasic-BodyB-Column1-Body1">
                        <p class="TableCell">plgross</p>
                    </td>
                    <td class="TableStyle-COINSBasic-BodyB-Column1-Body1">
                        <p class="TableCell">PL Gross</p>
                    </td>
                    <td class="TableStyle-COINSBasic-BodyB-Column1-Body1">
                        <p class="TableCell">Decimal</p>
                    </td>
                    <td class="TableStyle-COINSBasic-BodyB-Column1-Body1">
                        <p class="TableCell">-&gt;&gt;&gt;,&gt;&gt;&gt;,&gt;&gt;9.99</p>
                    </td>
                    <td class="TableStyle-COINSBasic-BodyA-Column1-Body1">
                        <p class="TableCell">ap_invoice.ain_amount</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>&#160;</p>
        <p>For both kco and job_num <MadCap:variable name="Variables.tick" /> the field called Key.&#160; This will summarise the Data Set by company and contract.</p>
        <p>&#160;</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Running the Report_2.png" class="FullWidth" MadCap:conditions="COINS.Pre-v1105" />
        </p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Exercise 1b Using multiple_C_1106.png" class="FullWidth" />
        </p>
        <h2>Create the Report</h2>
        <p>Copy the report definition for xxBI0011 and rename it xxBI0012.</p>
        <p>For this new report, modify the query to read our two Data Set tables:</p>
        <p class="Example">FOR EACH ttcontract,<br />FIRST ttPLinvoice WHERE ttPLinvoice.kco = ttcontract.kco <br />AND ttPLinvoice.job_num = ttcontract.job_num</p>
        <p class="note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #bed230;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;">There must be a relationship between the fields in each of the Data Sets.</p>
        <p>In the Data Set Definition field, list the Data Sets being used separated by commas</p>
        <p>For example:</p>
        <p>NLBI0009,NLBI0012</p>
        <p>&#160;</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Running the Report_3.png" class="FullWidth" MadCap:conditions="COINS.Pre-v1105" />
        </p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Exercise 1b Using multiple_D_1106.png" class="FullWidth" />
        </p>
        <p>Click <MadCap:snippetText src="../../../Resources/Snippets/Button Snippets/Button_Save_Both.flsnp" /></p>
        <p>On the Fields Tab, on the Body Form add an additional column for plgross</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Running the Report_4.png" class="FullWidth" MadCap:conditions="COINS.Pre-v1105" />
        </p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Exercise 1b Using multiple_E_1106.png" class="FullWidth" />
        </p>
        <p>Click <MadCap:snippetText src="../../../Resources/Snippets/Button Snippets/Button_LineSave_Both.flsnp" /></p>
        <h2>Running the report</h2>
        <p>Run the function xxBI0012.&#160; You should get output similar to the following:</p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Running the Report_5.png" class="FullWidth" MadCap:conditions="COINS.Pre-v1105" />
        </p>
        <p>
            <img src="../../../Resources/Images_A-C/BI/BI M2 Exercises/Exercise 1b Using multiple_F_1106.png" class="FullWidth" />
        </p>
    </body>
</html>